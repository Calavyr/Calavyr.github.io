<head>
<title>Game</title>
<meta name="google" content="notranslate">
<link href='https://fonts.googleapis.com/css?family=Comfortaa' rel='stylesheet'>
</head>

<style>
body {
background: #6DB4F7;
}

.noselect {
-moz-user-select: none;
-khtml-user-select: none;
-webkit-user-select: none;
-ms-user-select: none;
user-select: none;
}

#game {
background: #2992E3;
position: absolute;
left: 7.5%;
top: 5%;
width: 85%;
height: 90%;
}

#canvas {
position: absolute;
left: 5%;
top: 5%;
border-style: solid;
color: black;
cursor: none;
}
#canvasInfo {
background-color: #68D8F7;
position: absolute;
top: 86%;
height: 7.5%;
width: 45%;
left: 5%;
text-align: center;
color: black;
font-family: "Comfortaa";
font-weight: 700;
font-size: 36px;
line-height: 0;
border-style: solid;
}

#particulateHolder {
font-size: 48px;
font-family: "Comfortaa";
position: absolute;
left: 57.5%;
width: 35%;
height: 10%;
background: #68D8F7;
text-align: center;
vertical-align: middle;
line-height: 80px;
display: inline-block;
color: black;
border-style: solid;
}

#upgrades {
position: absolute;
top: 17.5%;
left: 56.375%;
width: 37.5%;
height: 75%;
color: black;
border-style: solid;
background: #72D8F7;
}

</style>


<body>
<div id="game" class="noselect">
<canvas id="canvas"></canvas>
<div id="canvasInfo">
<p><span id="particles">0</span>/<span id="maxparticles">10</span> Particles (+<span id="particleSec">0.5</span>/sec)</p>
</div>

<h1 id="particulateHolder"><span id="particulates">0</span> Particulates</h1>

<div id="upgrades">


</div>

</div>
</body>

<script>
var canvas = document.getElementById("canvas")
var ctx = canvas.getContext("2d")

var particulates = 0
var particulateMulti = 1


var part = 0
var particles = 0
var maxParticles = 10
var particlesPerSec = 0.5
var particleLocations = []
var particleSize = 15

var pickupRange = 25


var mousePos = 0


var placeholder = 0
setInterval(function() {
if (particles < maxParticles) {
	part += particlesPerSec / 20
	placeholder = particles
	particles = Math.floor(part)
	
	if (placeholder < particles) {
		drawParticles()
	}
}
detectCollection()
}, 50)

setInterval(function() {
document.getElementById("particles").innerHTML = particles
document.getElementById("maxparticles").innerHTML = maxParticles
document.getElementById("particleSec").innerHTML = particlesPerSec
document.getElementById("particulates").innerHTML = particulates
}, 50)





function drawParticles() {
canvasBackground()
ctx.fillStyle = "#ED6C34"
placeholder = particles
for (let j = 0; j < particleLocations.length; j++) {
placeholder -= 1
let x = particleLocations[j].x
let y = particleLocations[j].y
ctx.fillRect(x, y, particleSize, particleSize) 
}

for (let i = 0; i < placeholder; i++) {
let x = randomInteger(particleSize, canvas.width - particleSize)
let y = randomInteger(particleSize, canvas.height - particleSize)

particleLocations.push({x: x, y: y})

ctx.fillRect(x, y, particleSize, particleSize)
}

detectCollection()
}





window.addEventListener("mousemove", (evt) => {
drawParticles()
mousePos = getMousePos(canvas, evt)
detectCollection()
})



function detectCollection() {
ctx.fillStyle = "#88CCE3"
ctx.fillRect(mousePos.x - pickupRange / 2, mousePos.y - pickupRange / 2, pickupRange, pickupRange)

for (let i = 0; i < particleLocations.length; i++) {

	for (let j = Math.floor(pickupRange / 2) * -1; j < pickupRange / 2; j++) {
	
	
			for (let k = Math.floor(pickupRange / 2) * -1; k < pickupRange / 2; k++) {
			
				if (Math.floor(mousePos.x) + j == particleLocations[i].x) {
				
					if (Math.floor(mousePos.y) + k == particleLocations[i].y) {
					
					particleLocations.splice(i, 1)
					particles -= 1
					part = Math.max(0, part - 1)
					
					particulates += particulateMulti
					
					break
					
					}
				}
			}
}
}
}





resizeCanvas()
function resizeCanvas() {
let port = document.getElementById("game")
canvas.height = (port.clientHeight / 100) * 80
canvas.width = (port.clientWidth / 100) * 45
drawParticles()
}

canvasBackground()
function canvasBackground() {
ctx.fillStyle = "#63BCE6"
ctx.fillRect(0, 0, canvas.width, canvas.height)
}

window.addEventListener("resize", function() {
resizeCanvas()
})



function randomInteger(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function getMousePos(canvas, evt) {
  var rect = canvas.getBoundingClientRect();
  return {
    x: evt.clientX - rect.left,
    y: evt.clientY - rect.top
  };
}
</script>
